# Comprehensive Commands 

This document provides a comprehensive list of commands for each tool used in the One Health Wetland project, with detailed explanations of the flags and options used.

## Table of Contents
1. [Guppy Basecaller](#1-guppy-basecaller)
2. [Porechop](#2-porechop)
3. [NanoFilt](#3-nanofilt)
4. [Flye](#4-flye)
5. [Minimap2](#5-minimap2)
6. [Racon](#6-racon)
7. [Prodigal](#7-prodigal)
8. [EggNOG-mapper](#8-eggnog-mapper)
9. [CheckM](#9-checkm)
10. [Kraken2](#10-kraken2)
11. [DIAMOND](#11-diamond)
12. [NCBI-AMRFinderPlus](#12-ncbi-amrfinderplus)
13. [Prokka](#13-prokka)
14. [Bakta](#14-bakta)
15. [NanoStat](#15-nanostat)
16. [Assembly-Stats](#16-assembly-stats)

1. Dorado Basecaller
Converts raw electrical signal data from nanopore sequencing into DNA sequences, with support for both basecalling and demultiplexing.

# Basecalling
```bash
dorado basecaller /path/to/model_config -r /path/to/pod5_files > basecalled.fastq --kit-name SQK-RBK114-24 --no-trim --emit-fastq
```

# Demultiplexing
```bash
dorado demux --output-dir output_directory/ --kit-name SQK-RBK114-24 basecalled.fastq --emit-fastq
```

- `basecaller`: Command for converting raw signal to sequences
- `/path/to/model_config`: Path to the model configuration (e.g., dna_r10.4.1_e8.2_400bps_sup@v5.0.0)
- `-r /path/to/pod5_files`: Directory containing POD5 files
- `--kit-name`: Specifies the sequencing kit used
- `--no-trim`: Disables adapter trimming
- `--emit-fastq`: Outputs in FASTQ format
- `demux`: Command for demultiplexing barcoded samples
- `--output-dir`: Directory for demultiplexed output files

## 2. Porechop
Finds and removes adapters from Oxford Nanopore reads.

```bash
porechop -i input.fastq -o output.fastq
```

- `-i input.fastq`: Specifies the input FASTQ file containing raw reads
- `-o output.fastq`: Specifies the output FASTQ file for adapter-trimmed reads

## 3. NanoFilt
Filters Oxford Nanopore sequencing data based on quality and length.

```bash
gunzip -c input.fastq.gz | NanoFilt -q 9 -l 100 | gzip > output.fastq.gz
```

- `gunzip -c input.fastq.gz`: Decompresses the input file and writes to standard output
- `NanoFilt -q 9 -l 100`: Filters reads, keeping those with quality ≥ 9 and length ≥ 100 bases
- `gzip > output.fastq.gz`: Compresses the filtered output and saves it

## 4. Flye
De novo assembler for single-molecule sequencing reads, run in 'meta' mode for metagenomic data.

```bash
flye --meta --nano-raw input.fastq --out-dir output_directory 
```

- `--meta`: Enables metagenomic mode for assembling mixed samples
- `--nano-raw input.fastq`: Specifies input file of raw Nanopore reads
- `--out-dir output_directory`: Specifies the output directory for assembly results

## 5. Minimap2
Aligns DNA sequences against a large reference database.

```bash
minimap2 -ax map-ont /path/to/flye/output/assembly.fasta /path/to/nanofilt/output/reads.fastq | samtools sort -o /path/to/minimap2/output/reads.sorted.bam
```

- `-ax map-ont`: Sets the alignment mode for Oxford Nanopore reads
- `/path/to/flye/output/assembly.fasta`: Specifies the reference assembly
- `/path/to/nanofilt/output/reads.fastq`: Specifies the input reads to align
- `samtools sort -o /path/to/minimap2/output/reads.sorted.bam`: Sorts the alignment and outputs as a BAM file

## 6. Racon
Consensus module to correct raw contigs generated by rapid assembly methods.

```bash
racon /path/to/nanofilt/output/reads.fastq /path/to/minimap2/output/reads.sam /path/to/flye/output/assembly.fasta > /path/to/racon/output/assembly.polished.fasta
```

- First argument: Path to the filtered reads
- Second argument: Path to the alignment file (SAM format)
- Third argument: Path to the initial assembly
- `> /path/to/racon/output/assembly.polished.fasta`: Redirects the polished assembly to an output file

## 7. Prodigal
Microbial gene finding program.

```bash
prodigal -i /path/to/assembly.fasta -a /path/to/proteins.faa -o /path/to/prodigal_output.gbk -p meta
```

- `-i /path/to/assembly.fasta`: Specifies the input FASTA file
- `-a /path/to/proteins.faa`: Specifies the output file for protein sequences
- `-o /path/to/prodigal_output.gbk`: Specifies the output file in Genbank format
- `-p meta`: Sets the procedure to metagenomic mode

## 8. EggNOG-mapper
Tool for fast functional annotation of novel sequences.

```bash
emapper.py -i /path/to/proteins.faa -o /path/to/eggnog_output -m diamond --cpu 8 --data_dir /path/to/eggnog_data/
```

- `-i /path/to/proteins.faa`: Specifies the input protein FASTA file
- `-o /path/to/eggnog_output`: Specifies the output file prefix
- `-m diamond`: Sets the search method to DIAMOND
- `--cpu 8`: Sets the number of CPU cores to use
- `--data_dir /path/to/eggnog_data/`: Specifies the directory containing eggNOG data files

## 9. CheckM
Assesses the quality of genomes recovered from metagenomes.

```bash
checkm lineage_wf /path/to/bins/ /path/to/checkm_output/
```

- `lineage_wf`: Specifies the lineage-specific workflow
- `/path/to/bins/`: Specifies the directory containing genome bins
- `/path/to/checkm_output/`: Specifies the output directory for CheckM results

## 10. Kraken2
Assigns taxonomic labels to short DNA sequences.

```bash
kraken2 --db kraken_db_finalized --use-names --report report_samplename.txt --output output_samplename.txt sample.fastq --memory-mapping --threads 24
```

- `--db kraken_db_finalized`: Specifies the path to the Kraken2 database
- `--use-names`: Adds taxa names to the output
- `--report report_samplename.txt`: Specifies the file for the kraken report
- `--output output_samplename.txt`: Specifies the file for kraken output
- `sample.fastq`: Specifies the input FASTQ file
- `--memory-mapping`: Uses memory mapping to load the database, reducing memory usage
- `--threads 24`: Sets the number of threads to use

## 11. DIAMOND
Performs fast protein alignments.

```bash
diamond blastx -d diamond_db -q sample.fastq -o sample_name_blastx.dmnd_out -f 6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore staxids salltitles sscinames
```

- `blastx`: Specifies the BLASTX-like translated search
- `-d diamond_db`: Specifies the DIAMOND formatted database file
- `-q sample.fastq`: Specifies the input query file in FASTQ format
- `-o sample_name_blastx.dmnd_out`: Specifies the output file
- `-f 6`: Sets the output format to tabular
- The remaining parameters specify the fields to include in the output (e.g., query sequence id, subject sequence id, percentage of identical matches, etc.)

## 12. NCBI-AMRFinderPlus
AMRFinderPlus identifies antimicrobial resistance genes in protein or nucleotide sequences.

```bash
amrfinder -n input_assembly.fasta -o amrfinder_output.tsv --plus
```

- `-n input_assembly.fasta`: Specifies the input nucleotide FASTA file
- `-o amrfinder_output.tsv`: Specifies the output file name
- `--plus`: Enables the use of AMRFinderPlus, which includes point mutations

## 13. Prokka
Prokka is a tool for rapid prokaryotic genome annotation.

```bash
prokka --outdir prokka_output --prefix sample_name --kingdom Bacteria --locustag SAMPLE input_assembly.fasta
```

- `--outdir prokka_output`: Specifies the output directory
- `--prefix sample_name`: Sets the prefix for output files
- `--kingdom Bacteria`: Specifies the kingdom (could also be Archaea)
- `--locustag SAMPLE`: Sets the locus tag prefix for CDS features
- `input_assembly.fasta`: Specifies the input assembly file

## 14. Bakta
Bakta is a tool for the rapid & standardized annotation of bacterial genomes & plasmids.

```bash
bakta --db /path/to/bakta/db --output bakta_output --prefix sample_name input_assembly.fasta
```

- `--db /path/to/bakta/db`: Specifies the path to the Bakta database
- `--output bakta_output`: Specifies the output directory
- `--prefix sample_name`: Sets the prefix for output files
- `input_assembly.fasta`: Specifies the input assembly file

## 15. NanoStat
NanoStat generates statistics for Oxford Nanopore sequencing data.

```bash
NanoStat --fastq input_reads.fastq --outdir nanostat_output --name sample_name
```

- `--fastq input_reads.fastq`: Specifies the input FASTQ file
- `--outdir nanostat_output`: Specifies the output directory
- `--name sample_name`: Sets the prefix for the output file

## 16. Assembly-Stats
Assembly-Stats calculates various statistics for genome assemblies.

```bash
assembly-stats -t input_assembly.fasta > assembly_stats_output.txt
```

- `-t`: Enables tab-delimited output
- `input_assembly.fasta`: Specifies the input assembly file
- `> assembly_stats_output.txt`: Redirects the output to a file

Note: Replace file paths, database locations, and parameter values as needed for your specific setup and data. Consult each tool's documentation for detailed information on available options and best practices.
